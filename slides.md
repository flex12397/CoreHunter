# Core Hunter

<div class="presenter-footer">
Felix Li • <a href="mailto:felix.li12397@gmail.com">felix.li12397@gmail.com</a>
</div>

---

## Core Hunter是什么？

- 用于核心种质筛选的生物信息学工具  
- 从大规模遗传资源库中选取子集  
- 本报告主要讲解Core Hunter3各个算法，然后跟其他核心种质筛选工具做对比

---

## 评估指标

---

## 条目至最近条目(E-NE)

- 每个选定种质与最近其他条目间的平均距离  
- 最大化 → 高度多样化的核心集合  

![E-NE示意图](./images/Image1.png)

---

## 全库至最近条目(A-NE)

- 每个种质与最相似核心条目的平均距离  
- 最小化 → 能最佳代表完整集合中所有个体种质的核心集合  

![A-NE示意图](./images/Image2.png)

---

## 位点平均期望杂合度 (HE)

- 评估核心种质等位基因丰富度  

![HE示意图](./images/Image3.png)

---

# Core Hunter 3 核心算法

---

## 核心功能
- 主要局部搜索算法：
  - 随机下降算法（基础）
  - 并行回火算法（默认）
- 支持多目标加权指数优化
- 使用预设停止条件控制运行时间

---

## 随机下降算法
- 流程：
  1. 随机选择初始核心集
  2. 随机交换"已选-未选"样本
  3. 仅接受质量提升的交换
  4. 终止条件：当邻域内没有更优解
- 简单直接 ，计算很快


---

### 假设当前解子集为 {A, B, C} （ANE = 0.85)
1. 随机替换一个成员 -> 新解 {A, B, D}（ANE=0.82）
2. 0.82 < 0.85 -> 保留新解
3. 替换 {A, B, E}（ANE=0.83）-> 拒绝


---

## 并行回火算法（默认）
- 流程：
  - 10个并行搜索副本
  - 不同温度设置（高温更易接受次优解）
  - 定期交换副本间的解
- 优势：
  - 低温副本保证收敛
  - 高温副本探索新区域

---

### 假设从玉米数据中选择核心种质（ANE=0.8168）
- 高温链：可能接受ANE=0.83的解（暂时变差）
- 低温链：严格接受ANE<0.8168的解
- 交换：如果高温链找到更优区域，低温链跳过去搜索

---
## 算法精度对比
![算法精度对比](./images/Figure4.1.png)

- 核心发现：
  - 并行回火在所有测试数据集上表现更优
  - 稳定性显著提升：
    - 并行回火的标准差降低
    - 例如椰子数据：±3.18e-5 vs ±5.63e-4

---

## 过程对比
![收敛曲线](./images/Figure4.2.png)

- 动态过程分析：
  - 随机下降：前7秒快速提升，适合快速预览
  - 并行回火：7秒后反超，长期优化能力更强

---

## 实践建议
- 首选配置：CH3默认并行回火
- 快速场景：随机下降（小数据集）
- 精准需求：延长并行回火运行时间

---

# CoreHunter 玉米数据集核心种质筛选分析 

---

## 玉米数据
- 1250份种质资源，通过1117个SNP标记表征
- 来自R包synbreedData

---

## 参数设置  
- 算法：`并行回火算法  
- 停止条件：100秒
- 评估指标：全库至最近条目 (A-NE)
- 核心种质大小：100个材料

---

## A-NE优化过程  (Run 1)
- 初始值：`0.894400`  
- A-NE最终值：`0.816800`  
- 总步骤：491次迭代
- 子集结果：{470, 1024, 1108, 227, 791, … , 174, 646, 415, 1204, 745}


---

## 参数调后对比(Run 2)
- 停止条件：最大优化进步时间 5秒
- 同样A-NE最终值：`0.816800`  
- 总步骤：31次迭代（5秒)
- 22个种质重叠

---

## 同样A-NE，不同种质?
- 遗传冗余性
  - 数据集中存在许多遗传背景高度相似的样本
  - 从这些相似样本中任选一个代表几乎相同
- 高温链接受较差解，但是能扩大搜索范围

---

## E-NE优化过程  
- E-NE最终值：1.00（最高值）
- 子集结果：{0, 15, 29, 31, 49, … , 1155, 1159, 1161, 1183, 1193}

---

## 版本性能对比

- CH2
  - 混合副本搜索: 并行回火 + 构造启发式LR  
    - 构造性启发式算法  
    - 从空集开始逐步添加最优种质  
    - 每次迭代强制保持高最小距离
  - 专为优化最小距离设计  

- CH3  
  - 默认并行回火：  
    - 专注优化E-NE距离    

---

## 版本性能对比

- 测试方案：
  - 10次独立运行取均值±标准差
- 停止条件：
  - CH3：10秒无改进即停止
  - CH2: 10秒无改进即停止
  - CH2L: 确保LR副本完成

---

## 版本性能对比
![版本对比](./images/Table4.2.png)

---

## 版本性能对比
- CH3核心优势：
  - 质量更高：E-NE值全面超越CH2
  - 速度更快：豌豆数据集154秒 vs CH2L的802秒
  - 更稳定：自动停止条件无需手动调参

---

## 对比算法：GDOpt
- 目标：  
  - 专为最小化A-NE距离设计  
  - 确保全库每个种质都能在核心中找到"代表"  

- 流程：  
  1. 识别数据中心点
  2. 以中心点为锚点分区  
  3. 选择分区代表作为核心种质

---

## 对比算法：SimEli
- 目标：  
  - 迭代移除最相似种质对之一  
  - 淘汰标准：  
    - 最大化剩余种质距离 (SimEli-A-RA)  
    - 最大化预期杂合度 (SimEli-HE)
  - 强调E-NE优化  

---

## CH3 vs GDOpt vs SimEli

![多目标优化结果](./images/Figure4.3.png)

---

## CH3 vs GDOpt vs SimEli

- 代表性  
  1. GDOpt：专攻A-NE 
  2. CH3: 逼近GDOpt
  3. SimEli

- 多样性 
  1. CH3：E-NE全面领先  
  2. SimEli-A-RA
  3. GDOpt 

---

## 等位基因丰富度对比 (HE)
![HE优化结果](./images/Figure4.4.png)

---

## 等位基因丰富度对比 (HE)
- HE表现：  
  - GDOpt 显著低于其他
  - SimEli-HE表现更好，但CH3能够在HE和E-NE同时优于SimEli

---

## 速度性

![HE优化结果](./images/Table4.3.png)

---

## 速度性

- 小数据集：  
  - GDOpt/SimEli快 
  - 因CH3有并行回火 

- 大数据集：  
  - CH3反超（豌豆数据集快3倍）  
  - 并行回火发挥多核优势 

---

## 速度性

- CH3模式影响：  
  - 优化HE最快（简单指标）  
  - 优化A-NE最慢（计算密集）

---



## 总结：CH3优势
  
  - 首创E-NE/A-NE双目标优化  
  - "多样性-代表性"权衡
  - 大数据集效率提升
  - 支持基因型+表型数据



 


